<!DOCTYPE html>
<html>
<head>
    <title>登录状态检查</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a2e; color: #fff; }
        .box { background: #16213e; padding: 20px; margin: 20px 0; border-radius: 10px; }
        button { padding: 10px 20px; margin: 10px; background: #4ade80; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>🔍 登录状态检查</h1>
    
    <div class="box">
        <h2>当前状态:</h2>
        <div id="status"></div>
    </div>
    
    <div class="box">
        <h2>手动设置登录状态（测试用）:</h2>
        <button onclick="setTestLogin()">设置测试登录</button>
        <button onclick="clearLogin()">清除登录</button>
        <button onclick="location.reload()">刷新页面</button>
    </div>
    
    <script>
        function checkStatus() {
            const token = sessionStorage.getItem('auth_token');
            const user = sessionStorage.getItem('auth_user');
            
            let html = '<pre>';
            html += 'sessionStorage.auth_token: ' + (token || 'null') + '\n';
            html += 'sessionStorage.auth_user: ' + (user || 'null') + '\n\n';
            
            if (token && user) {
                try {
                    const userObj = JSON.parse(user);
                    html += '解析后的用户信息:\n' + JSON.stringify(userObj, null, 2);
                } catch (e) {
                    html += '解析失败: ' + e.message;
                }
            }
            html += '</pre>';
            
            document.getElementById('status').innerHTML = html;
        }
        
        function setTestLogin() {
            const testUser = {
                id: '1',
                username: 'admin',
                email: 'admin@web3hunter.com',
                role: 'admin',
                createdAt: new Date().toISOString()
            };
            
            sessionStorage.setItem('auth_token', 'authenticated');
            sessionStorage.setItem('auth_user', JSON.stringify(testUser));
            
            alert('✅ 测试登录已设置！刷新页面查看效果');
            checkStatus();
        }
        
        function clearLogin() {
            sessionStorage.removeItem('auth_token');
            sessionStorage.removeItem('auth_user');
            alert('✅ 登录信息已清除');
            checkStatus();
        }
        
        checkStatus();
    </script>
</body>
</html>
