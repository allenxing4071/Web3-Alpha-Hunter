# AI助手使用指南 - 实现跨对话记忆

> 本指南帮助AI助手在每次新对话时快速理解项目上下文，避免重复提问

## 🎯 为什么需要这个指南？

AI助手（如Claude Code）在每次新对话时会"失忆"，无法记住之前的对话内容。这会导致：

- ❌ 每次都要重新介绍项目
- ❌ 重复回答相同的问题
- ❌ 无法追踪项目演进历史
- ❌ 技术决策上下文丢失

通过本指南，AI助手可以：

- ✅ 快速理解项目全貌
- ✅ 了解已完成的工作
- ✅ 遵循已确定的技术规范
- ✅ 避免重复性工作

## 📋 AI助手工作流程

### 第一步: 读取上下文文件（必须）

每次新对话开始时，AI助手应该按顺序阅读以下文件：

```bash
# 1. 项目上下文记忆文件（核心）
.claudecontext

# 2. 项目规则文件
.clinerules

# 3. 主README
README.md

# 4. 文档导航
docs/README.md
```

### 第二步: 确认当前状态

```bash
# 检查git状态
git status

# 查看最近提交
git log --oneline -5

# 如果涉及数据库，查看数据库文档
docs/02-技术实现/04-数据库设计文档-完整版.md
```

### 第三步: 定位相关文档

根据用户问题类型，查找对应文档：

| 问题类型 | 查看文档 |
|---------|---------|
| 快速启动/部署 | `docs/快速指南/` |
| 功能开发 | `docs/03-功能模块/` |
| API接口 | `docs/02-技术实现/02-API接口文档.md` |
| 数据库操作 | `docs/02-技术实现/04-数据库设计文档-完整版.md` |
| 配置问题 | `guides/config/` |
| AI模型配置 | `guides/ai/` |

## 🔑 关键信息速查

### 技术栈
- **后端**: FastAPI + PostgreSQL + Redis + Celery
- **前端**: Next.js 14 + TypeScript + Tailwind + Zustand
- **AI**: OpenAI/Claude/DeepSeek
- **爬虫**: Playwright + Chrome MCP

### 项目结构
```
faxianjihui/
├── backend/          # FastAPI后端
├── frontend/         # Next.js前端
├── docs/             # 📚 技术文档
├── guides/           # 🔧 配置指南
└── scripts/          # 启动脚本
```

### 数据库核心表（22张）
- **用户**: users, user_roles
- **项目**: projects, project_categories, project_tags
- **KOL**: kols, kol_categories, kol_posts
- **评分**: ai_scores, risk_assessments
- **监控**: platform_monitors, data_collection_logs
- **审核**: moderation_queues, moderation_actions

详见: [04-数据库设计文档-完整版.md](./02-技术实现/04-数据库设计文档-完整版.md)

### 常用命令
```bash
# 启动开发环境
./scripts/start-dev.sh

# 停止服务
./scripts/stop-dev.sh

# 数据库迁移
cd backend && alembic upgrade head

# 查看API文档
open http://localhost:8000/docs
```

## 💡 智能问答策略

### 当用户问"如何开始？"

**AI助手应该**:
1. 检查 `.claudecontext` 确认项目状态
2. 提供 `docs/快速指南/快速启动.md` 的链接
3. 推荐使用 `./scripts/start-dev.sh` 启动

**不应该**:
- ❌ 直接复述所有启动步骤（文档里有）
- ❌ 忽略已有的启动脚本

### 当用户问"数据库表结构？"

**AI助手应该**:
1. 直接指向 `docs/02-技术实现/04-数据库设计文档-完整版.md`
2. 说明项目有22张表的完整设计文档
3. 询问用户具体想了解哪个模块的表

**不应该**:
- ❌ 从头解释所有表（文档里有）
- ❌ 猜测表结构（已有完整文档）

### 当用户问"如何添加新功能？"

**AI助手应该**:
1. 询问具体功能
2. 检查 `.claudecontext` 确认是否已实现
3. 查看 `docs/03-功能模块/` 是否有类似模块
4. 遵循 `.clinerules` 的开发规范

**不应该**:
- ❌ 直接开始写代码
- ❌ 忽略现有的功能模块文档

### 当用户问"为什么选择XX技术？"

**AI助手应该**:
1. 检查 `.claudecontext` 的"重要决策记录"部分
2. 如果有记录，直接引用
3. 如果没有记录，基于项目需求分析后更新 `.claudecontext`

**不应该**:
- ❌ 每次都重新分析（浪费时间）
- ❌ 给出与之前不一致的答案

## 🔄 记忆持久化流程

### 重要信息应该记录到 `.claudecontext`

以下类型的信息应该更新到上下文文件：

1. **重要技术决策**
   - 为什么选择某个技术栈
   - 架构设计的考虑因素
   - 被否决的方案及原因

2. **项目状态变更**
   - 新完成的核心功能
   - 数据库表结构变更
   - 新增的依赖或工具

3. **已知问题和解决方案**
   - 遇到的坑和解决方法
   - 配置问题的解决记录
   - 性能优化的经验

4. **下一步计划**
   - 待开发的功能
   - 需要优化的模块
   - 技术债务

### 更新模板

```markdown
## 🔄 最后更新

**更新时间**: 2025-XX-XX
**更新人**: [开发者名称 或 AI助手]
**主要变更**:
- 完成XXX功能
- 解决了XXX问题
- 新增XXX模块

**重要决策**:
- 决定使用XXX方案，理由是...
- 放弃XXX方案，因为...
```

## 🎯 最佳实践

### ✅ 好的做法

1. **每次对话开始前阅读上下文**
   ```
   用户: 帮我添加一个新功能
   AI: 好的，让我先查看项目的上下文文件...
       [阅读 .claudecontext]
       [阅读相关文档]
       了解了，项目现在处于XXX状态，我们可以...
   ```

2. **引用文档而非重复内容**
   ```
   用户: 数据库表结构是什么？
   AI: 项目有完整的数据库设计文档，包含22张表的详细设计。
       请查看: docs/02-技术实现/04-数据库设计文档-完整版.md
       需要我帮你查看某个特定模块的表结构吗？
   ```

3. **重大变更后更新上下文**
   ```
   AI: 功能开发完成！让我更新一下项目上下文文件...
       [更新 .claudecontext]
       已记录到上下文文件，下次对话可以直接引用。
   ```

### ❌ 避免的做法

1. **不读上下文直接开始**
   ```
   用户: 帮我添加功能
   AI: 好的，让我们从头开始... [开始重复已有的工作]
   ```

2. **重复回答相同问题**
   ```
   用户: 为什么用PostgreSQL？
   AI: [每次都重新分析一遍，给出不同的理由]
   ```

3. **忽略已有文档**
   ```
   用户: 如何启动项目？
   AI: [手动复述所有步骤，忽略 docs/快速指南/]
   ```

## 📚 文档层级

理解项目的文档层级有助于快速定位信息：

```
Level 1: 快速上手
├── .claudecontext          # 最核心的上下文记忆
├── README.md               # 项目概述
└── docs/快速指南/          # 5分钟快速启动

Level 2: 系统文档
├── docs/README.md          # 文档导航中心
├── docs/01-需求与设计/     # 需求和架构
├── docs/02-技术实现/       # 技术细节
└── docs/03-功能模块/       # 功能文档

Level 3: 配置指南
├── guides/config/          # 服务器/数据库/API配置
├── guides/ai/              # AI模型配置
└── guides/admin/           # 管理员操作

Level 4: 历史归档
└── docs/99-归档/           # 过时的文档
```

## 🤖 AI助手自检清单

每次新对话开始时，AI助手应该问自己：

- [ ] 我读过 `.claudecontext` 了吗？
- [ ] 我了解项目的当前状态吗？
- [ ] 我知道相关的文档在哪里吗？
- [ ] 这个问题之前是否回答过？
- [ ] 我的回答与之前的决策一致吗？

每次完成重要工作后，AI助手应该：

- [ ] 这个决策需要记录到 `.claudecontext` 吗？
- [ ] 相关文档需要更新吗？
- [ ] 有新的经验教训需要记录吗？
- [ ] 下次对话需要知道这些信息吗？

## 📞 示例对话

### 场景1: 新对话开始

```
用户: 帮我看看项目现在的状态

AI助手: 好的，让我先快速了解一下项目的上下文...
[阅读 .claudecontext, git status, git log]

根据上下文文件和git记录，项目目前状态：

✅ 已完成:
- 基础框架 (前后端)
- 22张数据库表设计
- KOL管理系统完整实现
- 用户认证和权限系统

🚧 进行中:
- X/Twitter数据采集
- AI分析引擎优化

📋 下一步计划:
- 自动化每日报告
- 实时监控看板

需要我帮你做什么？
```

### 场景2: 技术选型问题

```
用户: 为什么选择PostgreSQL而不是MySQL？

AI助手: 根据项目上下文文件中的技术决策记录：

选择PostgreSQL的原因:
1. 需要JSON字段支持 (存储复杂的AI分析结果)
2. 更好的扩展性 (项目数据量会快速增长)
3. 更强的JSONB查询能力
4. 更好的全文搜索支持

这个决策已经记录在 .claudecontext 中，有其他问题吗？
```

### 场景3: 功能开发

```
用户: 我想添加一个新的数据采集模块

AI助手: 好的！让我先查看一下现有的架构...
[阅读 docs/03-功能模块/04-平台监控系统.md]

项目已经有完整的数据采集架构，包括:
- platform_monitors 表
- data_collection_logs 表
- BasePlatformCollector 基类

建议你:
1. 继承 BasePlatformCollector 类
2. 实现新平台的采集逻辑
3. 在 platform_monitors 表添加新平台配置

需要我帮你生成具体代码吗？还是先看看现有的实现？
```

## 🎓 总结

通过这套体系，AI助手可以：

1. **快速恢复上下文** - 通过 `.claudecontext` 文件
2. **遵循项目规范** - 通过 `.clinerules` 文件
3. **避免重复工作** - 通过查阅现有文档
4. **保持答案一致** - 通过记录重要决策
5. **提高工作效率** - 通过文档分层和快速定位

**关键原则**:
- 📖 文档优先，避免重复
- 🔍 上下文第一，保持一致
- 📝 重要决策，持久记录
- 🎯 快速定位，提高效率

---

**文档版本**: v1.0
**创建时间**: 2025-10-13
**维护者**: AI助手 + 开发团队
