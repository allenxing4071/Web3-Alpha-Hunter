# éƒ¨ç½²æŒ‡å—

## ğŸ¯ éƒ¨ç½²æ¶æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç”¨æˆ·è¯·æ±‚    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Cloudflare  â”‚ (CDN + DDoSé˜²æŠ¤)
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Vercel       â”‚            â”‚  Railway.app    â”‚
    â”‚  (å‰ç«¯)        â”‚            â”‚  (åç«¯API)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚                 â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
            â”‚  Supabase    â”‚    â”‚  Upstash      â”‚  â”‚  Celery     â”‚
            â”‚  (PostgreSQL)â”‚    â”‚  (Redis)      â”‚  â”‚  Workers    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å‰ç«¯éƒ¨ç½² (Vercel)

### æ­¥éª¤1: å‡†å¤‡ä»£ç 

ç¡®ä¿é¡¹ç›®æ ¹ç›®å½•æœ‰ä»¥ä¸‹æ–‡ä»¶:

```bash
web3-alpha-hunter-web/
â”œâ”€â”€ package.json
â”œâ”€â”€ next.config.js
â”œâ”€â”€ .env.example
â””â”€â”€ .gitignore
```

**next.config.js**:
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  env: {
    NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL,
    NEXT_PUBLIC_WS_URL: process.env.NEXT_PUBLIC_WS_URL,
  },
  images: {
    domains: ['cdn.example.com'],
  },
}

module.exports = nextConfig
```

---

### æ­¥éª¤2: è¿æ¥Vercel

**æ–¹å¼1: é€šè¿‡Vercel Dashboard**

1. è®¿é—® https://vercel.com
2. ç‚¹å‡» "New Project"
3. å¯¼å…¥GitHubä»“åº“
4. é€‰æ‹©æ¡†æ¶: Next.js (è‡ªåŠ¨æ£€æµ‹)
5. é…ç½®ç¯å¢ƒå˜é‡:

```
NEXT_PUBLIC_API_URL=https://api.web3alphahunter.com
NEXT_PUBLIC_WS_URL=wss://api.web3alphahunter.com/ws
```

6. ç‚¹å‡» "Deploy"

**æ–¹å¼2: é€šè¿‡Vercel CLI**

```bash
# å®‰è£…Vercel CLI
npm i -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
cd web3-alpha-hunter-web
vercel

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
vercel --prod
```

---

### æ­¥éª¤3: é…ç½®è‡ªå®šä¹‰åŸŸå

1. åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­é€‰æ‹© "Domains"
2. æ·»åŠ åŸŸå: `app.web3alphahunter.com`
3. é…ç½®DNSè®°å½• (Vercelä¼šæä¾›å…·ä½“æŒ‡ä»¤):

```
Type: CNAME
Name: app
Value: cname.vercel-dns.com
```

4. ç­‰å¾…SSLè¯ä¹¦è‡ªåŠ¨é…ç½® (é€šå¸¸1-5åˆ†é’Ÿ)

---

### æ­¥éª¤4: é…ç½®ç¯å¢ƒå˜é‡ (åˆ†ç¯å¢ƒ)

**Previewç¯å¢ƒ** (ç”¨äºæµ‹è¯•):
```
NEXT_PUBLIC_API_URL=https://api-staging.web3alphahunter.com
```

**Productionç¯å¢ƒ**:
```
NEXT_PUBLIC_API_URL=https://api.web3alphahunter.com
```

---

## ğŸ”§ åç«¯éƒ¨ç½² (Railway.app)

### æ­¥éª¤1: å‡†å¤‡ä»£ç 

**Dockerfile**:
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶ä»£ç 
COPY app/ ./app/

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

**railway.toml**:
```toml
[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "uvicorn app.main:app --host 0.0.0.0 --port $PORT"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
```

---

### æ­¥éª¤2: éƒ¨ç½²åˆ°Railway

1. è®¿é—® https://railway.app
2. ç‚¹å‡» "New Project" â†’ "Deploy from GitHub repo"
3. é€‰æ‹©åç«¯ä»“åº“
4. Railwayè‡ªåŠ¨æ£€æµ‹Dockerfileå¹¶å¼€å§‹æ„å»º

---

### æ­¥éª¤3: é…ç½®ç¯å¢ƒå˜é‡

åœ¨Railway Dashboardè®¾ç½®:

```bash
# æ•°æ®åº“
DATABASE_URL=postgresql://user:pass@host:5432/dbname

# Redis
REDIS_URL=redis://default:pass@host:6379

# APIå¯†é’¥
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
TWITTER_API_KEY=...
TELEGRAM_BOT_TOKEN=...

# å®‰å…¨
SECRET_KEY=your-super-secret-key-change-this
CORS_ORIGINS=https://app.web3alphahunter.com

# ç¯å¢ƒ
ENVIRONMENT=production
```

---

### æ­¥éª¤4: é…ç½®è‡ªå®šä¹‰åŸŸå

1. åœ¨Railwayé¡¹ç›®è®¾ç½®ä¸­é€‰æ‹© "Settings" â†’ "Domains"
2. ç‚¹å‡» "Generate Domain" è·å¾—RailwayåŸŸå
3. æ·»åŠ è‡ªå®šä¹‰åŸŸå: `api.web3alphahunter.com`
4. é…ç½®DNS:

```
Type: CNAME
Name: api
Value: <your-project>.up.railway.app
```

---

### æ­¥éª¤5: é…ç½®å¥åº·æ£€æŸ¥

**app/main.py**:
```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/health")
async def health_check():
    """å¥åº·æ£€æŸ¥ç«¯ç‚¹"""
    return {
        "status": "healthy",
        "version": "1.0.0"
    }
```

---

## ğŸ—„ï¸ æ•°æ®åº“éƒ¨ç½² (Supabase)

### æ­¥éª¤1: åˆ›å»ºé¡¹ç›®

1. è®¿é—® https://supabase.com
2. åˆ›å»ºæ–°é¡¹ç›®: "web3-alpha-hunter"
3. é€‰æ‹©åŒºåŸŸ: Singapore (äºšæ´²ç”¨æˆ·) / Ohio (ç¾å›½ç”¨æˆ·)
4. è®¾ç½®æ•°æ®åº“å¯†ç  (ä¿å­˜åˆ°å¯†ç ç®¡ç†å™¨)

---

### æ­¥éª¤2: è¿è¡Œæ•°æ®åº“è¿ç§»

**å®‰è£…Alembic** (æ•°æ®åº“è¿ç§»å·¥å…·):
```bash
pip install alembic
```

**åˆå§‹åŒ–Alembic**:
```bash
alembic init alembic
```

**åˆ›å»ºè¿ç§»è„šæœ¬**:
```bash
alembic revision --autogenerate -m "Initial schema"
```

**æ‰§è¡Œè¿ç§»**:
```bash
# æœ¬åœ°æµ‹è¯•
alembic upgrade head

# ç”Ÿäº§ç¯å¢ƒ (ä½¿ç”¨Supabaseè¿æ¥å­—ç¬¦ä¸²)
DATABASE_URL=postgresql://... alembic upgrade head
```

---

### æ­¥éª¤3: é…ç½®è¿æ¥æ± 

**app/db/session.py**:
```python
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

DATABASE_URL = os.getenv("DATABASE_URL")

engine = create_engine(
    DATABASE_URL,
    pool_size=20,           # è¿æ¥æ± å¤§å°
    max_overflow=10,        # é¢å¤–è¿æ¥æ•°
    pool_pre_ping=True,     # è¿æ¥å‰æ£€æŸ¥
    pool_recycle=3600,      # 1å°æ—¶å›æ”¶è¿æ¥
)

SessionLocal = sessionmaker(bind=engine)
```

---

## ğŸ”´ Rediséƒ¨ç½² (Upstash)

### æ­¥éª¤1: åˆ›å»ºRediså®ä¾‹

1. è®¿é—® https://upstash.com
2. åˆ›å»ºæ•°æ®åº“: "web3-alpha-hunter-cache"
3. é€‰æ‹©åŒºåŸŸ: Global (è¾¹ç¼˜ç¼“å­˜)
4. å¤åˆ¶è¿æ¥å­—ç¬¦ä¸²

---

### æ­¥éª¤2: é…ç½®Rediså®¢æˆ·ç«¯

**app/core/redis.py**:
```python
import redis
from app.core.config import settings

redis_client = redis.from_url(
    settings.REDIS_URL,
    decode_responses=True
)

# æµ‹è¯•è¿æ¥
def test_redis():
    try:
        redis_client.ping()
        print("âœ… Redis connected")
    except Exception as e:
        print(f"âŒ Redis error: {e}")
```

---

## âš™ï¸ Celery Workeréƒ¨ç½²

### æ–¹æ¡ˆ1: Railway (æ¨è)

**åˆ›å»ºæ–°æœåŠ¡**:
1. åœ¨Railwayé¡¹ç›®ä¸­ç‚¹å‡» "New Service"
2. é€‰æ‹©åŒä¸€ä¸ªGitHubä»“åº“
3. ä¿®æ”¹å¯åŠ¨å‘½ä»¤:

```bash
celery -A app.tasks.celery worker --loglevel=info
```

**ç¯å¢ƒå˜é‡**: ä¸ä¸»APIæœåŠ¡ç›¸åŒ

---

### æ–¹æ¡ˆ2: Docker Compose (æœ¬åœ°/VPS)

**docker-compose.yml**:
```yaml
version: '3.8'

services:
  api:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
    depends_on:
      - redis
      
  celery_worker:
    build: .
    command: celery -A app.tasks.celery worker --loglevel=info
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
    depends_on:
      - redis
      
  celery_beat:
    build: .
    command: celery -A app.tasks.celery beat --loglevel=info
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
    depends_on:
      - redis
      
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
```

**å¯åŠ¨**:
```bash
docker-compose up -d
```

---

## ğŸ“¦ å¯¹è±¡å­˜å‚¨ (Cloudflare R2)

### æ­¥éª¤1: åˆ›å»ºR2 Bucket

1. ç™»å½•Cloudflare Dashboard
2. è¿›å…¥ "R2" â†’ "Create bucket"
3. å‘½å: `web3-alpha-hunter-assets`
4. åˆ›å»ºAPI Token

---

### æ­¥éª¤2: é…ç½®S3å…¼å®¹å®¢æˆ·ç«¯

```python
import boto3
from botocore.config import Config

s3_client = boto3.client(
    's3',
    endpoint_url='https://<account-id>.r2.cloudflarestorage.com',
    aws_access_key_id=settings.R2_ACCESS_KEY_ID,
    aws_secret_access_key=settings.R2_SECRET_ACCESS_KEY,
    config=Config(signature_version='s3v4')
)

# ä¸Šä¼ æ–‡ä»¶
s3_client.upload_file(
    'whitepaper.pdf',
    'web3-alpha-hunter-assets',
    'whitepapers/project-123.pdf'
)

# ç”Ÿæˆå…¬å¼€URL
url = f"https://cdn.example.com/whitepapers/project-123.pdf"
```

---

## ğŸ”’ SSL/HTTPSé…ç½®

### Vercel (è‡ªåŠ¨)
- âœ… è‡ªåŠ¨æä¾›Let's Encryptè¯ä¹¦
- âœ… è‡ªåŠ¨ç»­æœŸ
- âœ… HTTP/2æ”¯æŒ

### Railway (è‡ªåŠ¨)
- âœ… è‡ªåŠ¨HTTPS
- âœ… è‡ªåŠ¨è¯ä¹¦ç®¡ç†

### Cloudflare (æ¨èé¢å¤–é…ç½®)
1. æ·»åŠ åŸŸååˆ°Cloudflare
2. è®¾ç½®SSLæ¨¡å¼: "Full (strict)"
3. å¼€å¯ "Always Use HTTPS"
4. å¼€å¯ "Automatic HTTPS Rewrites"

---

## ğŸ“Š ç›‘æ§é…ç½®

### Sentry (é”™è¯¯è¿½è¸ª)

**å‰ç«¯é…ç½®**:
```typescript
// app/layout.tsx
import * as Sentry from "@sentry/nextjs"

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 0.1,
})
```

**åç«¯é…ç½®**:
```python
import sentry_sdk
from sentry_sdk.integrations.fastapi import FastApiIntegration

sentry_sdk.init(
    dsn=settings.SENTRY_DSN,
    environment=settings.ENVIRONMENT,
    traces_sample_rate=0.1,
    integrations=[FastApiIntegration()]
)
```

---

### Better Stack (æ—¥å¿—ç®¡ç†)

```python
import logging
from logtail import LogtailHandler

handler = LogtailHandler(source_token=settings.LOGTAIL_TOKEN)
logger = logging.getLogger(__name__)
logger.addHandler(handler)

logger.info("Application started", extra={
    "environment": settings.ENVIRONMENT,
    "version": "1.0.0"
})
```

---

## ğŸ”„ CI/CDé…ç½®

### GitHub Actions

**.github/workflows/deploy.yml**:
```yaml
name: Deploy

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run tests
        run: |
          pip install -r requirements.txt
          pytest
          
  deploy-frontend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          
  deploy-backend:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy to Railway
        run: |
          npm i -g @railway/cli
          railway up --service backend
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
```

---

## ğŸ§ª ç¯å¢ƒç®¡ç†

### ä¸‰å¥—ç¯å¢ƒ

| ç¯å¢ƒ | ç”¨é€” | åŸŸå | æ•°æ®åº“ |
|------|------|------|--------|
| Development | æœ¬åœ°å¼€å‘ | localhost:3000 | æœ¬åœ°PostgreSQL |
| Staging | æµ‹è¯• | staging.web3alphahunter.com | Supabase (å•ç‹¬é¡¹ç›®) |
| Production | ç”Ÿäº§ | app.web3alphahunter.com | Supabase (ç”Ÿäº§) |

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

**éƒ¨ç½²å‰**:
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ•°æ®åº“è¿ç§»å·²å‡†å¤‡
- [ ] APIå¯†é’¥å·²è®¾ç½®
- [ ] ç›‘æ§å·¥å…·å·²é…ç½®

**éƒ¨ç½²å**:
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡ (`/health`)
- [ ] APIæ–‡æ¡£å¯è®¿é—® (`/docs`)
- [ ] å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½
- [ ] WebSocketè¿æ¥æ­£å¸¸
- [ ] å®šæ—¶ä»»åŠ¡è¿è¡Œæ­£å¸¸
- [ ] é”™è¯¯æ—¥å¿—æ­£å¸¸ä¸ŠæŠ¥
- [ ] æ€§èƒ½ç›‘æ§æ•°æ®æ­£å¸¸

---

## ğŸš¨ å›æ»šç­–ç•¥

### Vercel (ä¸€é”®å›æ»š)
1. è¿›å…¥é¡¹ç›® â†’ "Deployments"
2. æ‰¾åˆ°ä¹‹å‰çš„ç¨³å®šç‰ˆæœ¬
3. ç‚¹å‡» "ï¸™" â†’ "Promote to Production"

### Railway
1. è¿›å…¥é¡¹ç›® â†’ "Deployments"
2. é€‰æ‹©ä¹‹å‰çš„éƒ¨ç½²ç‰ˆæœ¬
3. ç‚¹å‡» "Redeploy"

### æ•°æ®åº“å›æ»š
```bash
# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
alembic downgrade -1

# å›æ»šåˆ°ç‰¹å®šç‰ˆæœ¬
alembic downgrade <revision_id>
```

---

## ğŸ’° æˆæœ¬é¢„ä¼°

| æœåŠ¡ | æ–¹æ¡ˆ | å…è´¹é¢åº¦ | ä»˜è´¹å |
|------|------|----------|--------|
| Vercel | Pro | 100GBå¸¦å®½ | $20/æœˆ |
| Railway | Hobby | $5ä¿¡ç”¨é¢ | $5èµ·/æœˆ |
| Supabase | Free | 500MBæ•°æ®åº“ | $25/æœˆ (Pro) |
| Upstash | Free | 10Kå‘½ä»¤/å¤© | $0.2/100Kå‘½ä»¤ |
| Cloudflare R2 | - | 10GBå­˜å‚¨ | $0.015/GB |
| Sentry | Free | 5Ké”™è¯¯/æœˆ | $26/æœˆ |

**æ€»è®¡**: 
- å…è´¹é˜¶æ®µ: ~$5/æœˆ
- ä»˜è´¹é˜¶æ®µ: ~$80-100/æœˆ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-02

