# æœåŠ¡å™¨è¿æ¥æŒ‡å—

> **æœ€åæ›´æ–°**: 2025-10-04
> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0

---

## ğŸ” æœåŠ¡å™¨ä¿¡æ¯

### ç”Ÿäº§æœåŠ¡å™¨

| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| **IPåœ°å€** | `47.253.226.250` |
| **ç”¨æˆ·å** | `root` |
| **è®¤è¯æ–¹å¼** | SSHå¯†é’¥å¯¹ |
| **å¯†é’¥æ–‡ä»¶** | `VPNKEY.pem` (é¡¹ç›®æ ¹ç›®å½•) |
| **SSHç«¯å£** | `22` (é»˜è®¤) |

---

## ğŸš€ å¿«é€Ÿè¿æ¥

### æ–¹å¼1: ä½¿ç”¨å¯†é’¥æ–‡ä»¶ç›´æ¥è¿æ¥

```bash
# ç¡®ä¿å¯†é’¥æ–‡ä»¶æƒé™æ­£ç¡®
chmod 600 VPNKEY.pem

# SSHè¿æ¥
ssh -i VPNKEY.pem root@47.253.226.250
```

### æ–¹å¼2: é…ç½®SSH Config (æ¨è)

ç¼–è¾‘ `~/.ssh/config`:

```bash
# æ·»åŠ ä»¥ä¸‹é…ç½®
Host web3-alpha-server
    HostName 47.253.226.250
    User root
    IdentityFile /Users/xinghailong/Documents/soft/faxianjihui/VPNKEY.pem
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

ç„¶åå¯ä»¥ç®€åŒ–è¿æ¥:

```bash
ssh web3-alpha-server
```

---

## ğŸ“‹ å¸¸ç”¨æ“ä½œ

### 1. è¿æ¥åˆ°æœåŠ¡å™¨

```bash
ssh -i VPNKEY.pem root@47.253.226.250
```

### 2. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

```bash
# ä¸Šä¼ å•ä¸ªæ–‡ä»¶
scp -i VPNKEY.pem local_file.txt root@47.253.226.250:/path/to/destination/

# ä¸Šä¼ ç›®å½•
scp -i VPNKEY.pem -r local_dir/ root@47.253.226.250:/path/to/destination/
```

### 3. ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶

```bash
# ä¸‹è½½å•ä¸ªæ–‡ä»¶
scp -i VPNKEY.pem root@47.253.226.250:/path/to/remote_file.txt ./

# ä¸‹è½½ç›®å½•
scp -i VPNKEY.pem -r root@47.253.226.250:/path/to/remote_dir/ ./
```

### 4. ä½¿ç”¨rsyncåŒæ­¥æ–‡ä»¶

```bash
# åŒæ­¥æœ¬åœ°åˆ°æœåŠ¡å™¨
rsync -avz -e "ssh -i VPNKEY.pem" ./backend/ root@47.253.226.250:/app/backend/

# åŒæ­¥æœåŠ¡å™¨åˆ°æœ¬åœ°
rsync -avz -e "ssh -i VPNKEY.pem" root@47.253.226.250:/app/backend/ ./backend/
```

---

## ğŸ”§ æœåŠ¡å™¨ç¯å¢ƒæ£€æŸ¥

### è¿æ¥åé¦–æ¬¡æ£€æŸ¥

```bash
# 1. æ£€æŸ¥ç³»ç»Ÿä¿¡æ¯
cat /etc/os-release
uname -a

# 2. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# 3. æ£€æŸ¥å†…å­˜
free -h

# 4. æ£€æŸ¥CPU
lscpu

# 5. æ£€æŸ¥è¿è¡Œçš„æœåŠ¡
systemctl list-units --type=service --state=running

# 6. æ£€æŸ¥Docker
docker --version
docker ps

# 7. æ£€æŸ¥ç½‘ç»œ
ip addr
netstat -tulpn
```

---

## ğŸ“¦ é¡¹ç›®éƒ¨ç½²è·¯å¾„å»ºè®®

```bash
# åˆ›å»ºåº”ç”¨ç›®å½•
ssh -i VPNKEY.pem root@47.253.226.250 << 'EOF'
  mkdir -p /app/web3-alpha-hunter
  mkdir -p /app/web3-alpha-hunter/backend
  mkdir -p /app/web3-alpha-hunter/frontend
  mkdir -p /app/web3-alpha-hunter/data
  mkdir -p /app/web3-alpha-hunter/logs
  mkdir -p /app/web3-alpha-hunter/backups
EOF
```

**æ¨èç›®å½•ç»“æ„:**
```
/app/web3-alpha-hunter/
â”œâ”€â”€ backend/          # åç«¯ä»£ç 
â”œâ”€â”€ frontend/         # å‰ç«¯ä»£ç  (å¯é€‰)
â”œâ”€â”€ data/             # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ logs/             # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ backups/          # å¤‡ä»½æ–‡ä»¶
â””â”€â”€ docker-compose.yml
```

---

## ğŸ³ Dockeréƒ¨ç½²ç¤ºä¾‹

### 1. ä¸Šä¼ docker-compose.yml

```bash
scp -i VPNKEY.pem docker-compose.yml root@47.253.226.250:/app/web3-alpha-hunter/
```

### 2. ä¸Šä¼ ç¯å¢ƒå˜é‡æ–‡ä»¶

```bash
scp -i VPNKEY.pem backend/.env root@47.253.226.250:/app/web3-alpha-hunter/backend/
```

### 3. SSHåˆ°æœåŠ¡å™¨å¹¶å¯åŠ¨æœåŠ¡

```bash
ssh -i VPNKEY.pem root@47.253.226.250

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /app/web3-alpha-hunter

# æ‹‰å–é•œåƒ
docker-compose pull

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. å¯†é’¥æ–‡ä»¶å®‰å…¨

```bash
# âš ï¸ ç¡®ä¿å¯†é’¥æ–‡ä»¶æƒé™æ­£ç¡®
chmod 600 VPNKEY.pem

# âš ï¸ ä¸è¦å°†å¯†é’¥æ–‡ä»¶æäº¤åˆ°Git
# æ£€æŸ¥ .gitignore æ˜¯å¦åŒ…å«
cat .gitignore | grep VPNKEY.pem
```

### 2. é…ç½®é˜²ç«å¢™

```bash
ssh -i VPNKEY.pem root@47.253.226.250

# å®‰è£…ufw
apt update && apt install ufw -y

# å…è®¸SSH
ufw allow 22/tcp

# å…è®¸HTTP/HTTPS
ufw allow 80/tcp
ufw allow 443/tcp

# å…è®¸åç«¯APIç«¯å£ (ä¾‹å¦‚8000)
ufw allow 8000/tcp

# å¯ç”¨é˜²ç«å¢™
ufw enable

# æŸ¥çœ‹çŠ¶æ€
ufw status
```

### 3. è®¾ç½®SSHå¯†é’¥ç™»å½•åç¦ç”¨å¯†ç ç™»å½•

```bash
ssh -i VPNKEY.pem root@47.253.226.250

# ç¼–è¾‘SSHé…ç½®
vi /etc/ssh/sshd_config

# ä¿®æ”¹ä»¥ä¸‹é…ç½®
# PasswordAuthentication no
# PubkeyAuthentication yes

# é‡å¯SSHæœåŠ¡
systemctl restart sshd
```

### 4. åˆ›å»ºérootç”¨æˆ· (æ¨è)

```bash
# åˆ›å»ºéƒ¨ç½²ç”¨æˆ·
useradd -m -s /bin/bash deployer
passwd deployer

# æ·»åŠ sudoæƒé™
usermod -aG sudo deployer

# å¤åˆ¶SSHå¯†é’¥æˆæƒ
mkdir -p /home/deployer/.ssh
cp /root/.ssh/authorized_keys /home/deployer/.ssh/
chown -R deployer:deployer /home/deployer/.ssh
chmod 700 /home/deployer/.ssh
chmod 600 /home/deployer/.ssh/authorized_keys
```

---

## ğŸ“Š æœåŠ¡å™¨ç›‘æ§

### å®æ—¶ç›‘æ§å‘½ä»¤

```bash
# CPUå’Œå†…å­˜ç›‘æ§
htop

# ç£ç›˜IOç›‘æ§
iotop

# ç½‘ç»œç›‘æ§
iftop

# Dockerå®¹å™¨ç›‘æ§
docker stats

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep python
ps aux | grep node
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# ç³»ç»Ÿæ—¥å¿—
journalctl -xe

# Dockeræ—¥å¿—
docker-compose logs -f --tail=100

# Nginxæ—¥å¿—
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

---

## ğŸ”„ å¸¸ç”¨ç»´æŠ¤å‘½ä»¤

### é‡å¯æœåŠ¡

```bash
# é‡å¯DockeræœåŠ¡
cd /app/web3-alpha-hunter
docker-compose restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart backend
docker-compose restart frontend

# å®Œå…¨é‡å»º
docker-compose down
docker-compose up -d --build
```

### æ›´æ–°ä»£ç 

```bash
# æ–¹å¼1: åœ¨æœåŠ¡å™¨ä¸Šgit pull
cd /app/web3-alpha-hunter
git pull origin main
docker-compose up -d --build

# æ–¹å¼2: ä»æœ¬åœ°æ¨é€
rsync -avz -e "ssh -i VPNKEY.pem" \
  --exclude 'node_modules' \
  --exclude '.git' \
  --exclude '__pycache__' \
  ./backend/ root@47.253.226.250:/app/web3-alpha-hunter/backend/
```

### æ•°æ®åº“å¤‡ä»½

```bash
# å¤‡ä»½PostgreSQL
ssh -i VPNKEY.pem root@47.253.226.250 << 'EOF'
  docker-compose exec -T postgres pg_dump -U postgres web3_alpha_hunter \
    | gzip > /app/web3-alpha-hunter/backups/db_backup_$(date +%Y%m%d_%H%M%S).sql.gz
EOF

# ä¸‹è½½å¤‡ä»½åˆ°æœ¬åœ°
scp -i VPNKEY.pem root@47.253.226.250:/app/web3-alpha-hunter/backups/*.sql.gz ./backups/
```

---

## ğŸš¨ æ•…éšœæ’æŸ¥

### 1. æ— æ³•è¿æ¥æœåŠ¡å™¨

```bash
# æ£€æŸ¥ç½‘ç»œ
ping 47.253.226.250

# æ£€æŸ¥SSHç«¯å£
telnet 47.253.226.250 22

# æ£€æŸ¥å¯†é’¥æƒé™
ls -la VPNKEY.pem
# åº”è¯¥æ˜¾ç¤º: -rw------- (600)
```

### 2. æœåŠ¡æ— æ³•è®¿é—®

```bash
ssh -i VPNKEY.pem root@47.253.226.250

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tulpn | grep 8000

# æ£€æŸ¥é˜²ç«å¢™
ufw status

# æ£€æŸ¥æ—¥å¿—
docker-compose logs backend --tail=100
```

### 3. ç£ç›˜ç©ºé—´ä¸è¶³

```bash
# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥æ‰¾å¤§æ–‡ä»¶
du -sh /* | sort -h

# æ¸…ç†Docker
docker system prune -a --volumes

# æ¸…ç†æ—¥å¿—
journalctl --vacuum-time=7d
```

---

## ğŸ“± ç§»åŠ¨ç«¯è¿æ¥

### iOS/iPadOS (ä½¿ç”¨Termius)

1. ä¸‹è½½Termiusåº”ç”¨
2. æ·»åŠ æ–°ä¸»æœº:
   - Label: Web3 Alpha Server
   - Hostname: 47.253.226.250
   - Username: root
3. æ·»åŠ å¯†é’¥:
   - å¤åˆ¶VPNKEY.pemå†…å®¹
   - ç²˜è´´åˆ°Termius

### Android (ä½¿ç”¨JuiceSSH)

1. ä¸‹è½½JuiceSSHåº”ç”¨
2. åˆ›å»ºæ–°è¿æ¥
3. å¯¼å…¥SSHå¯†é’¥

---

## ğŸ“‹ å¿«é€Ÿå‘½ä»¤å¤‡å¿˜å½•

```bash
# è¿æ¥
ssh -i VPNKEY.pem root@47.253.226.250

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# é‡å¯æœåŠ¡
docker-compose restart

# è¿›å…¥å®¹å™¨
docker-compose exec backend bash

# æŸ¥çœ‹èµ„æºä½¿ç”¨
htop

# æŸ¥çœ‹ç£ç›˜
df -h
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²æŒ‡å—](./01-éƒ¨ç½²æŒ‡å—.md) - å®Œæ•´éƒ¨ç½²æµç¨‹
- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](../02-æŠ€æœ¯å®ç°/04-æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md) - æ•°æ®ï¿½ï¿½å¤‡ä»½æ¢å¤

---

## âš ï¸ é‡è¦æé†’

1. **å¯†é’¥å®‰å…¨**
   - âŒ ä¸è¦å°†VPNKEY.pemæäº¤åˆ°Git
   - âŒ ä¸è¦é€šè¿‡ä¸å®‰å…¨çš„æ¸ é“åˆ†äº«å¯†é’¥
   - âœ… å®šæœŸè½®æ¢SSHå¯†é’¥

2. **æœåŠ¡å™¨å®‰å…¨**
   - âœ… å®šæœŸæ›´æ–°ç³»ç»Ÿ: `apt update && apt upgrade`
   - âœ… å¯ç”¨é˜²ç«å¢™
   - âœ… ç¦ç”¨å¯†ç ç™»å½•
   - âœ… ä½¿ç”¨érootç”¨æˆ·éƒ¨ç½²

3. **æ•°æ®å¤‡ä»½**
   - âœ… æ¯æ—¥è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“
   - âœ… å¤‡ä»½åˆ°å¼‚åœ°å­˜å‚¨
   - âœ… å®šæœŸæµ‹è¯•å¤‡ä»½æ¢å¤

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-04
**ç»´æŠ¤è€…**: è¿ç»´å›¢é˜Ÿ
