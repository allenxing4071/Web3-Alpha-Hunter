# ç¬¬ä¸‰æ–¹é‡‡é›†æœåŠ¡é…ç½®æŒ‡å—

**å®Œæˆæ—¶é—´**: 2025-01-07  
**ç›®çš„**: ä½¿ç”¨Apifyç­‰ç¬¬ä¸‰æ–¹æœåŠ¡æ›¿ä»£Twitterå®˜æ–¹APIï¼Œå®ç°ä½æˆæœ¬é«˜é¢‘æ•°æ®é‡‡é›†

---

## ğŸ“‹ é…ç½®æ¸…å•

### å¿…é¡»é…ç½® (P0)

#### 1. Apify API (Twitteré‡‡é›†)

**æ³¨å†Œæ­¥éª¤**:
1. è®¿é—® https://apify.com/
2. ç‚¹å‡» "Sign Up" æ³¨å†Œè´¦å·
3. è¿›å…¥ Dashboard â†’ Settings â†’ Integrations
4. å¤åˆ¶ "Personal API token"

**é…ç½®ç¯å¢ƒå˜é‡**:
```bash
# backend/.env
APIFY_API_KEY=apify_api_xxxxxxxxxxxxxxxxxxxxxxxx
APIFY_TWITTER_ACTOR_ID=apify/twitter-scraper
```

**å®šä»·**:
- **å…è´¹å¥—é¤**: $5 é¢åº¦ (çº¦1000æ¬¡è°ƒç”¨)
- **Starterå¥—é¤**: $49/æœˆ (100k actor runs) â­æ¨è
- **Teamå¥—é¤**: $499/æœˆ (1M actor runs)

**é…é¢è¯´æ˜**:
- æ¯æ¬¡é‡‡é›† = 1ä¸ªactor run
- æ¯15åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡ = 96æ¬¡/å¤© = 2,880æ¬¡/æœˆ
- Starterå¥—é¤å®Œå…¨å¤Ÿç”¨ï¼ˆ100kæ¬¡/æœˆ >> 2,880æ¬¡/æœˆï¼‰

---

#### 2. Telegram API (å…è´¹)

**æ³¨å†Œæ­¥éª¤**:
1. è®¿é—® https://my.telegram.org/
2. ä½¿ç”¨æ‰‹æœºå·ç™»å½•
3. ç‚¹å‡» "API development tools"
4. å¡«å†™åº”ç”¨ä¿¡æ¯:
   - App title: `Web3 Alpha Hunter`
   - Short name: `web3hunter`
   - Platform: `Other`
5. ç‚¹å‡» "Create application"
6. å¤åˆ¶ `api_id` å’Œ `api_hash`

**é…ç½®ç¯å¢ƒå˜é‡**:
```bash
# backend/.env
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**é™åˆ¶**:
- å®Œå…¨å…è´¹
- æ— è°ƒç”¨æ¬¡æ•°é™åˆ¶
- éœ€è¦éµå®ˆ Telegram æœåŠ¡æ¡æ¬¾

---

#### 3. AIåˆ†ææœåŠ¡ (è‡³å°‘é…ç½®ä¸€ä¸ª)

##### æ–¹æ¡ˆA: DeepSeek (æ¨è - å›½å†…)

**æ³¨å†Œæ­¥éª¤**:
1. è®¿é—® https://platform.deepseek.com/
2. æ³¨å†Œè´¦å·
3. è¿›å…¥ "API Keys" é¡µé¢
4. åˆ›å»ºæ–°å¯†é’¥

**é…ç½®ç¯å¢ƒå˜é‡**:
```bash
# backend/.env
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**å®šä»·**:
- è¾“å…¥: Â¥1/ç™¾ä¸‡tokens
- è¾“å‡º: Â¥2/ç™¾ä¸‡tokens
- æ¯æœˆæˆæœ¬: ~Â¥50-150 (å–å†³äºåˆ†æé‡)

##### æ–¹æ¡ˆB: OpenAI (å¯é€‰)

```bash
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

##### æ–¹æ¡ˆC: Anthropic Claude (å¯é€‰)

```bash
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

---

## ğŸš€ å¿«é€Ÿé…ç½®æµç¨‹

### æ­¥éª¤1: å®‰è£…ä¾èµ–

```bash
cd /Users/xinghailong/Documents/soft/faxianjihui/backend
pip install -r requirements.txt
```

### æ­¥éª¤2: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶æ¨¡æ¿æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™ä»¥ä¸‹å¿…éœ€é…ç½®
nano .env
```

**å¿…é¡»å¡«å†™çš„å­—æ®µ**:
```bash
# AIåˆ†æ
DEEPSEEK_API_KEY=sk-xxxxxx

# Twitteré‡‡é›†
APIFY_API_KEY=apify_api_xxxxxx

# Telegramé‡‡é›†
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=xxxxxx
```

### æ­¥éª¤3: é‡å¯CeleryæœåŠ¡

```bash
# åœæ­¢æ—§æœåŠ¡
./stop-celery.sh

# å¯åŠ¨æ–°æœåŠ¡
./start-celery.sh
```

### æ­¥éª¤4: éªŒè¯é…ç½®

```bash
# æŸ¥çœ‹Workeræ—¥å¿—
tail -f /tmp/celery-worker.log

# åº”è¯¥çœ‹åˆ°:
# âœ… Apify Twitter collector initialized
# âœ… Telegram client initialized
```

---

## ğŸ§ª æµ‹è¯•é‡‡é›†

### æµ‹è¯•Apify Twitteré‡‡é›†

```bash
cd backend
python3 -c "
from app.services.collectors.twitter_apify import twitter_apify_collector
projects = twitter_apify_collector.collect_and_extract(hours=24)
print(f'âœ… Collected {len(projects)} projects')
for p in projects[:3]:
    print(f'  - {p.get(\"name\")}: {p.get(\"description\")[:50]}...')
"
```

**é¢„æœŸè¾“å‡º**:
```
âœ… Apify Twitter collector initialized
ğŸ” Searching tweets for: presale (max: 30)
âœ… Found 25 tweets for query: presale
...
âœ… Collected 15 projects
  - NewToken: Announcing presale for NewToken - revolutionary...
  - AirdropProject: Join our airdrop campaign...
```

### æµ‹è¯•Telegramé‡‡é›†

```bash
python3 -c "
import asyncio
from app.services.collectors.telegram import telegram_collector

async def test():
    await telegram_collector.start_client()
    messages = await telegram_collector.get_channel_messages('@cryptonewsflash', limit=10)
    print(f'âœ… Collected {len(messages)} messages')
    for m in messages[:3]:
        print(f'  - {m.get(\"text\", \"\")[:50]}...')

asyncio.run(test())
"
```

---

## ğŸ“Š æˆæœ¬é¢„ä¼°

### æ¯æœˆæ€»æˆæœ¬: $49-99

| æœåŠ¡ | æœˆæˆæœ¬ | è¯´æ˜ |
|------|--------|------|
| **Apify** | $49 | Starterå¥—é¤ï¼Œ100kæ¬¡è°ƒç”¨/æœˆ |
| **Telegram** | $0 | å®Œå…¨å…è´¹ |
| **CoinGecko** | $0 | å…è´¹API (50æ¬¡/åˆ†é’Ÿ) |
| **DeepSeek** | Â¥50-150 ($7-21) | æŒ‰ä½¿ç”¨é‡è®¡è´¹ |
| **æ€»è®¡** | **$56-70/æœˆ** | è¿œä½äºTwitterå®˜æ–¹API ($100/æœˆ) |

### æ¯æ—¥æ•°æ®é‡‡é›†é‡

| å¹³å° | é‡‡é›†é¢‘ç‡ | æ¯æ¬¡æ•°æ®é‡ | æ¯æ—¥æ€»é‡ |
|------|----------|------------|----------|
| **Twitter** | 15åˆ†é’Ÿ | 50-200æ¡ | 4,800-19,200æ¡ |
| **Telegram** | 15åˆ†é’Ÿ | 30-100æ¡ | 2,880-9,600æ¡ |
| **CoinGecko** | 30åˆ†é’Ÿ | 20-30ä¸ªé¡¹ç›® | 960-1,440ä¸ªé¡¹ç›® |
| **æ€»è®¡** | - | - | **~10,000-30,000æ¡/å¤©** |

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: ApifyæŠ¥é”™ "API key not configured"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥ .env æ–‡ä»¶
cat backend/.env | grep APIFY_API_KEY

# 2. ç¡®è®¤æ ¼å¼æ­£ç¡®
APIFY_API_KEY=apify_api_xxxxxxxxx  # åº”è¯¥ä»¥ apify_api_ å¼€å¤´

# 3. é‡å¯Celery
./stop-celery.sh && ./start-celery.sh
```

### é—®é¢˜2: TelegramæŠ¥é”™ "Failed to initialize client"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥API IDå’ŒHash
cat backend/.env | grep TELEGRAM

# 2. ç¡®è®¤ä¸¤ä¸ªå€¼éƒ½å·²é…ç½®
TELEGRAM_API_ID=12345678          # æ•°å­—
TELEGRAM_API_HASH=abcd1234efgh    # 32ä½å­—ç¬¦ä¸²

# 3. åˆ é™¤sessionæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
rm backend/web3_alpha_hunter.session

# 4. é‡å¯Celery
./stop-celery.sh && ./start-celery.sh
```

### é—®é¢˜3: Celeryæ—¥å¿—æ˜¾ç¤º "No Twitter collector configured"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿è‡³å°‘é…ç½®äº†ä¸€ä¸ªTwitteré‡‡é›†å™¨
# ä¼˜å…ˆçº§: APIFY_API_KEY > TWITTER_BEARER_TOKEN

# æ£€æŸ¥é…ç½®
cat backend/.env | grep -E "APIFY_API_KEY|TWITTER_BEARER_TOKEN"
```

---

## ğŸ“ˆ ç›‘æ§ä¸ä¼˜åŒ–

### æŸ¥çœ‹é‡‡é›†ç»Ÿè®¡

```bash
# æ•°æ®åº“æŸ¥è¯¢
cd backend
python3 << EOF
from app.db.session import SessionLocal
from sqlalchemy import text

db = SessionLocal()
result = db.execute(text("""
    SELECT platform, data_collected, projects_discovered 
    FROM platform_daily_stats 
    WHERE stat_date = CURRENT_DATE
"""))

for row in result:
    print(f"{row[0]:12} | é‡‡é›†:{row[1]:5} | é¡¹ç›®:{row[2]:5}")

db.close()
EOF
```

### è°ƒæ•´é‡‡é›†é¢‘ç‡

**é™ä½é¢‘ç‡ï¼ˆèŠ‚çœé…é¢ï¼‰**:
```python
# backend/app/tasks/celery_app.py
"collect-twitter-data": {
    "schedule": crontab(minute="*/30"),  # ä»15åˆ†é’Ÿæ”¹ä¸º30åˆ†é’Ÿ
}
```

**æé«˜é¢‘ç‡ï¼ˆå®æ—¶æ€§æ›´å¼ºï¼‰**:
```python
"collect-twitter-data": {
    "schedule": crontab(minute="*/10"),  # ä»15åˆ†é’Ÿæ”¹ä¸º10åˆ†é’Ÿ
}
```

---

## âœ… éªŒè¯æ¸…å•

å®Œæˆé…ç½®åï¼Œè¯·é€é¡¹æ£€æŸ¥:

- [ ] Apifyè´¦å·å·²æ³¨å†Œï¼ŒAPI Keyå·²é…ç½®
- [ ] Telegramå¼€å‘è€…è´¦å·å·²æ³¨å†Œï¼ŒAPI ID/Hashå·²é…ç½®
- [ ] DeepSeek/OpenAI/Claudeè‡³å°‘ä¸€ä¸ªå·²é…ç½®
- [ ] `.env` æ–‡ä»¶å·²åˆ›å»ºï¼Œæ‰€æœ‰å¿…éœ€å­—æ®µå·²å¡«å†™
- [ ] ä¾èµ–å·²å®‰è£… (`pip install -r requirements.txt`)
- [ ] CeleryæœåŠ¡å·²é‡å¯
- [ ] Workeræ—¥å¿—æ˜¾ç¤ºé‡‡é›†å™¨åˆå§‹åŒ–æˆåŠŸ
- [ ] æ‰‹åŠ¨æµ‹è¯•Twitteré‡‡é›†æˆåŠŸ
- [ ] æ‰‹åŠ¨æµ‹è¯•Telegramé‡‡é›†æˆåŠŸ
- [ ] ç®¡ç†é¢æ¿æ˜¾ç¤ºæ•°æ®ç»Ÿè®¡æ­£å¸¸

---

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

### P1 - çŸ­æœŸ (1å‘¨å†…):
1. ç›‘æ§Apifyé…é¢ä½¿ç”¨æƒ…å†µ
2. æ ¹æ®æ•°æ®è´¨é‡è°ƒæ•´å…³é”®è¯åˆ—è¡¨
3. ä¼˜åŒ–KOLç›‘æ§åˆ—è¡¨

### P2 - ä¸­æœŸ (1æœˆå†…):
1. æ·»åŠ æ›´å¤šTelegramé¢‘é“
2. å®ç°æ•°æ®å»é‡ç®—æ³•ä¼˜åŒ–
3. æ·»åŠ Discordé‡‡é›†å™¨

### P3 - é•¿æœŸ (3æœˆå†…):
1. æ¥å…¥Redditæ•°æ®æº
2. æ¥å…¥Medium RSS
3. å®ç°å¤šç»´åº¦æ•°æ®èåˆåˆ†æ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **Apifyæ–‡æ¡£**: https://docs.apify.com/
- **Telegram APIæ–‡æ¡£**: https://core.telegram.org/api
- **DeepSeekæ–‡æ¡£**: https://platform.deepseek.com/docs
- **é¡¹ç›®æ€»ä½“æ¶æ„**: `/docs/02-æŠ€æœ¯å®ç°/01-æŠ€æœ¯é€‰å‹.md`

---

**é…ç½®å®Œæˆå**ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å¼€å§‹é«˜é¢‘æ•°æ®é‡‡é›†ï¼Œæ¯15åˆ†é’Ÿä»Twitterå’ŒTelegramè·å–æœ€æ–°Web3é¡¹ç›®ä¿¡æ¯ï¼
