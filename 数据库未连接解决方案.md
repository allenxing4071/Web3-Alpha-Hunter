# ğŸ”§ æ•°æ®åº“æœªè¿æ¥ - è§£å†³æ–¹æ¡ˆ

## ğŸ“Š å½“å‰çŠ¶æ€

**é—®é¢˜**: æ•°æ®åº“ç®¡ç†UIæ˜¾ç¤ºè¡¨æ•°é‡æ²¡æœ‰å˜åŒ–ï¼ˆä»ç„¶æ˜¯5å¼ è¡¨ï¼‰

**åŸå› **: PostgreSQLæ•°æ®åº“æœªè¿è¡Œï¼Œæ— æ³•è¿æ¥

**é”™è¯¯ä¿¡æ¯**:
```
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
Is the server running on that host and accepting TCP/IP connections?
```

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: å¯åŠ¨PostgreSQLæ•°æ®åº“ (æ¨è)

#### MacOS

**æ£€æŸ¥PostgreSQLæ˜¯å¦å·²å®‰è£…**:
```bash
which psql
postgres --version
```

**å¦‚æœæœªå®‰è£…ï¼Œä½¿ç”¨Homebrewå®‰è£…**:
```bash
brew install postgresql@14
```

**å¯åŠ¨PostgreSQL**:
```bash
# æ–¹æ³•1: ä½¿ç”¨brew servicesï¼ˆæ¨èï¼‰
brew services start postgresql@14

# æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨
pg_ctl -D /usr/local/var/postgres start

# æ–¹æ³•3: å¦‚æœä½¿ç”¨Postgres.app
# å¯åŠ¨Postgres.appåº”ç”¨ç¨‹åº
```

**éªŒè¯PostgreSQLå·²å¯åŠ¨**:
```bash
psql -U postgres -c "SELECT version();"
```

**åˆ›å»ºæ•°æ®åº“**:
```bash
# è¿æ¥åˆ°PostgreSQL
psql -U postgres

# åˆ›å»ºæ•°æ®åº“
CREATE DATABASE web3_alpha_hunter;

# åˆ›å»ºç”¨æˆ·ï¼ˆå¦‚æœéœ€è¦ï¼‰
CREATE USER web3_user WITH PASSWORD 'your_password';

# æˆæƒ
GRANT ALL PRIVILEGES ON DATABASE web3_alpha_hunter TO web3_user;

# é€€å‡º
\q
```

**è¿è¡Œæ•°æ®åº“è¿ç§»**:
```bash
cd backend
python3 -m alembic upgrade head
```

---

### æ–¹æ¡ˆ2: ä½¿ç”¨Dockerè¿è¡ŒPostgreSQL (ç®€å•å¿«é€Ÿ)

**å¯åŠ¨PostgreSQLå®¹å™¨**:
```bash
docker run -d \
  --name web3-postgres \
  -e POSTGRES_DB=web3_alpha_hunter \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -p 5432:5432 \
  postgres:14-alpine
```

**éªŒè¯å®¹å™¨è¿è¡Œ**:
```bash
docker ps | grep web3-postgres
```

**è¿è¡Œæ•°æ®åº“è¿ç§»**:
```bash
cd backend
python3 -m alembic upgrade head
```

**åœæ­¢å®¹å™¨**ï¼ˆä¸éœ€è¦æ—¶ï¼‰:
```bash
docker stop web3-postgres
```

**é‡å¯å®¹å™¨**:
```bash
docker start web3-postgres
```

---

### æ–¹æ¡ˆ3: ä½¿ç”¨SQLite (ä¸´æ—¶æµ‹è¯•æ–¹æ¡ˆ)

å¦‚æœä¸æƒ³å®‰è£…PostgreSQLï¼Œå¯ä»¥ä¸´æ—¶ä½¿ç”¨SQLiteè¿›è¡Œæµ‹è¯•ã€‚

**ä¿®æ”¹æ•°æ®åº“é…ç½®**:

ç¼–è¾‘ `backend/app/core/config.py`:
```python
# åŸé…ç½®
# DATABASE_URL: str = "postgresql://postgres:postgres@localhost:5432/web3_alpha_hunter"

# æ”¹ä¸ºSQLite
DATABASE_URL: str = "sqlite:///./web3_alpha_hunter.db"
```

**ä¿®æ”¹alembicé…ç½®**:

ç¼–è¾‘ `backend/alembic.ini`:
```ini
# åŸé…ç½®
# sqlalchemy.url = postgresql://postgres:postgres@localhost:5432/web3_alpha_hunter

# æ”¹ä¸ºSQLite
sqlalchemy.url = sqlite:///./web3_alpha_hunter.db
```

**è¿è¡Œè¿ç§»**:
```bash
cd backend
python3 -m alembic upgrade head
```

**æ³¨æ„**: SQLiteä¸æ”¯æŒæŸäº›PostgreSQLç‰¹æ€§ï¼ˆå¦‚JSONç±»å‹çš„é«˜çº§æŸ¥è¯¢ï¼‰ï¼Œä»…ç”¨äºå¼€å‘æµ‹è¯•ã€‚

---

## ğŸš€ è¿ç§»åéªŒè¯

### 1. æ£€æŸ¥è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ

**æ–¹æ³•1: ä½¿ç”¨psql**
```bash
psql -U postgres -d web3_alpha_hunter -c "\dt"
```

**é¢„æœŸè¾“å‡º**:
```
 Schema |           Name            | Type  |  Owner   
--------+---------------------------+-------+----------
 public | ai_analysis               | table | postgres
 public | airdrop_value_estimates   | table | postgres
 public | ai_config                 | table | postgres
 public | investment_action_plans   | table | postgres
 public | onchain_metrics           | table | postgres
 public | project_discoveries       | table | postgres
 public | projects                  | table | postgres
 public | social_metrics            | table | postgres
 public | token_launch_predictions  | table | postgres
```

**ç°åœ¨åº”è¯¥çœ‹åˆ°9å¼ è¡¨**ï¼ˆåŸæ¥5å¼  + æ–°å¢4å¼ ï¼‰!

---

### 2. åˆ·æ–°UIç•Œé¢

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ•°æ®åº“ç®¡ç†é¡µé¢
2. åˆ·æ–°é¡µé¢ï¼ˆF5æˆ–Cmd+Rï¼‰
3. åº”è¯¥çœ‹åˆ°ï¼š
   - **æ•°æ®è¡¨**: 9å¼ ï¼ˆä»5å¼ å¢åŠ åˆ°9å¼ ï¼‰
   - **æ–°å¢è¡¨**: 
     - token_launch_predictions
     - airdrop_value_estimates
     - investment_action_plans
     - project_discoveries

---

### 3. æŸ¥çœ‹æ–°è¡¨ç»“æ„

**æŸ¥çœ‹æ‰€æœ‰è¡¨çš„è¯¦ç»†ä¿¡æ¯**:
```sql
SELECT 
    table_name,
    (SELECT COUNT(*) FROM information_schema.columns 
     WHERE table_name = t.table_name) as column_count
FROM information_schema.tables t
WHERE table_schema = 'public'
ORDER BY table_name;
```

**æŸ¥çœ‹ç‰¹å®šè¡¨çš„ç»“æ„**:
```bash
# å‘å¸æ¦‚ç‡é¢„æµ‹è¡¨
psql -U postgres -d web3_alpha_hunter -c "\d token_launch_predictions"

# ç©ºæŠ•ä»·å€¼ä¼°ç®—è¡¨
psql -U postgres -d web3_alpha_hunter -c "\d airdrop_value_estimates"

# æŠ•èµ„è¡ŒåŠ¨è®¡åˆ’è¡¨
psql -U postgres -d web3_alpha_hunter -c "\d investment_action_plans"

# é¡¹ç›®å‘ç°è®°å½•è¡¨
psql -U postgres -d web3_alpha_hunter -c "\d project_discoveries"
```

---

## ğŸ“ æ•°æ®åº“é…ç½®æ–‡ä»¶

### å½“å‰é…ç½®

**é…ç½®æ–‡ä»¶**: `backend/app/core/config.py`

```python
DATABASE_URL: str = Field(
    default="postgresql://postgres:postgres@localhost:5432/web3_alpha_hunter"
)
```

### ä¿®æ”¹é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœæ‚¨çš„PostgreSQLé…ç½®ä¸åŒï¼Œè¯·ä¿®æ”¹ï¼š
- **ç”¨æˆ·å**: postgres â†’ ä½ çš„ç”¨æˆ·å
- **å¯†ç **: postgres â†’ ä½ çš„å¯†ç 
- **ä¸»æœº**: localhost â†’ ä½ çš„ä¸»æœº
- **ç«¯å£**: 5432 â†’ ä½ çš„ç«¯å£
- **æ•°æ®åº“å**: web3_alpha_hunter â†’ ä½ çš„æ•°æ®åº“å

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1: "psql: command not found"
**è§£å†³**: PostgreSQLæœªå®‰è£…æˆ–æœªæ·»åŠ åˆ°PATH
```bash
# MacOS - æ·»åŠ åˆ°PATH
echo 'export PATH="/usr/local/opt/postgresql@14/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

### é—®é¢˜2: "FATAL: database does not exist"
**è§£å†³**: åˆ›å»ºæ•°æ®åº“
```bash
createdb web3_alpha_hunter
# æˆ–
psql -U postgres -c "CREATE DATABASE web3_alpha_hunter;"
```

### é—®é¢˜3: "FATAL: role does not exist"
**è§£å†³**: åˆ›å»ºç”¨æˆ·
```bash
psql -U postgres -c "CREATE USER your_username WITH PASSWORD 'your_password';"
```

### é—®é¢˜4: è¿ç§»ç‰ˆæœ¬å†²çª
**è§£å†³**: æŸ¥çœ‹å½“å‰ç‰ˆæœ¬å¹¶é‡ç½®
```bash
# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
python3 -m alembic current

# æŸ¥çœ‹å†å²
python3 -m alembic history

# é™çº§åˆ°æŒ‡å®šç‰ˆæœ¬
python3 -m alembic downgrade <revision>

# å‡çº§åˆ°æœ€æ–°
python3 -m alembic upgrade head
```

---

## ğŸ¯ å¿«é€Ÿå¯åŠ¨æµç¨‹ï¼ˆæ¨èï¼‰

**ä½¿ç”¨Dockerçš„å®Œæ•´æµç¨‹**:

```bash
# 1. å¯åŠ¨PostgreSQL
docker run -d \
  --name web3-postgres \
  -e POSTGRES_DB=web3_alpha_hunter \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -p 5432:5432 \
  postgres:14-alpine

# 2. ç­‰å¾…æ•°æ®åº“å¯åŠ¨ï¼ˆ5-10ç§’ï¼‰
sleep 10

# 3. è¿è¡Œæ•°æ®åº“è¿ç§»
cd /Users/xinghailong/Documents/soft/faxianjihui/backend
python3 -m alembic upgrade head

# 4. éªŒè¯
docker exec web3-postgres psql -U postgres -d web3_alpha_hunter -c "\dt"

# 5. åˆ·æ–°UIç•Œé¢
# åœ¨æµè§ˆå™¨ä¸­åˆ·æ–° http://localhost:3000 çš„æ•°æ®åº“ç®¡ç†é¡µé¢
```

**é¢„æœŸç»“æœ**:
- âœ… PostgreSQLå®¹å™¨è¿è¡Œ
- âœ… æ•°æ®åº“åˆ›å»ºæˆåŠŸ
- âœ… 9å¼ è¡¨åˆ›å»ºæˆåŠŸ
- âœ… UIç•Œé¢æ˜¾ç¤º9å¼ è¡¨

---

## ğŸ“Š è¿ç§»å‰åå¯¹æ¯”

### è¿ç§»å‰
```
æ•°æ®è¡¨: 5
â”œâ”€â”€ projects (é¡¹ç›®è¡¨)
â”œâ”€â”€ social_metrics (ç¤¾äº¤æŒ‡æ ‡)
â”œâ”€â”€ onchain_metrics (é“¾ä¸Šæ•°æ®)
â”œâ”€â”€ ai_analysis (AIåˆ†æ)
â””â”€â”€ ai_config (AIé…ç½®)
```

### è¿ç§»å
```
æ•°æ®è¡¨: 9 (+4)
â”œâ”€â”€ projects (é¡¹ç›®è¡¨)
â”œâ”€â”€ social_metrics (ç¤¾äº¤æŒ‡æ ‡)
â”œâ”€â”€ onchain_metrics (é“¾ä¸Šæ•°æ®)
â”œâ”€â”€ ai_analysis (AIåˆ†æ)
â”œâ”€â”€ ai_config (AIé…ç½®)
â”œâ”€â”€ token_launch_predictions (å‘å¸é¢„æµ‹) âœ¨ æ–°å¢
â”œâ”€â”€ airdrop_value_estimates (ç©ºæŠ•ä¼°ç®—) âœ¨ æ–°å¢
â”œâ”€â”€ investment_action_plans (è¡ŒåŠ¨è®¡åˆ’) âœ¨ æ–°å¢
â””â”€â”€ project_discoveries (é¡¹ç›®å‘ç°) âœ¨ æ–°å¢
```

---

## ğŸ’¡ ä¸‹ä¸€æ­¥

è¿ç§»æˆåŠŸåï¼š

1. âœ… æ•°æ®åº“ç»“æ„å·²æ›´æ–°
2. âœ… UIç•Œé¢æ˜¾ç¤º9å¼ è¡¨
3. â³ æ›´æ–°APIæ¥å£ä¿å­˜æ•°æ®åˆ°æ–°è¡¨
4. â³ å‰ç«¯å±•ç¤ºæ–°åŠŸèƒ½æ•°æ®
5. â³ é›†æˆå®Œæ•´å·¥ä½œæµ

---

**æ–‡æ¡£æ›´æ–°**: 2025-10-05  
**è§£å†³æ–¹æ¡ˆ**: å¯åŠ¨PostgreSQL + è¿è¡Œè¿ç§»  
**é¢„æœŸç»“æœ**: ä»5å¼ è¡¨æ‰©å±•åˆ°9å¼ è¡¨

